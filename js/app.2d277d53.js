(function(t){function e(e){for(var n,r,c=e[0],h=e[1],a=e[2],l=0,f=[];l<c.length;l++)r=c[l],Object.prototype.hasOwnProperty.call(s,r)&&s[r]&&f.push(s[r][0]),s[r]=0;for(n in h)Object.prototype.hasOwnProperty.call(h,n)&&(t[n]=h[n]);u&&u(e);while(f.length)f.shift()();return o.push.apply(o,a||[]),i()}function i(){for(var t,e=0;e<o.length;e++){for(var i=o[e],n=!0,c=1;c<i.length;c++){var h=i[c];0!==s[h]&&(n=!1)}n&&(o.splice(e--,1),t=r(r.s=i[0]))}return t}var n={},s={app:0},o=[];function r(e){if(n[e])return n[e].exports;var i=n[e]={i:e,l:!1,exports:{}};return t[e].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.m=t,r.c=n,r.d=function(t,e,i){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},r.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)r.d(i,n,function(e){return t[e]}.bind(null,n));return i},r.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="/beige/";var c=window["webpackJsonp"]=window["webpackJsonp"]||[],h=c.push.bind(c);c.push=e,c=c.slice();for(var a=0;a<c.length;a++)e(c[a]);var u=h;o.push([0,"chunk-vendors"]),i()})({0:function(t,e,i){t.exports=i("56d7")},"034f":function(t,e,i){"use strict";var n=i("85ec"),s=i.n(n);s.a},"56d7":function(t,e,i){"use strict";i.r(e);i("e260"),i("e6cf"),i("cca6"),i("a79d");var n=i("2b0e"),s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"app"}},[i("Board"),i("Keyboard"),i("CtrlPanel",{attrs:{id:"ctrlpanel",width:500,height:100}})],1)},o=[],r=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"Board"},[i("canvas",{ref:"canvas",staticClass:"canvas",attrs:{width:t.width,height:t.height}})])},c=[],h=(i("a9e3"),i("2f62")),a=(i("b0c0"),i("b64b"),function(t,e){this.ctx=t,this.targetObjs={},this.parent=e,this.draw=function(){for(var t in this.ctx.beginPath(),this.ctx.strokeStyle="white",this.targetObjs){var i=this.targetObjs[t].rect.getCenter(),n=e.getCenter();this.ctx.moveTo(n.x,n.y),this.ctx.lineTo(i.x,i.y)}this.ctx.stroke()},this.connect=function(t){this.targetObjs[t.name]=t},this.disConnect=function(t){console.log(t)}}),u=(i("0d03"),function(t,e,i,n){this.x=t,this.y=e,this.width=i,this.height=n,this.getCenter=function(){return new l(this.x+.5*this.width,this.y+.5*this.height)}}),l=function(t,e){this.x=t,this.y=e},f=function(t,e){return e.x>=t.x&&e.x<t.x+t.width&&e.y>=t.y&&e.y<t.y+t.height};l.add=function(t,e){return new l(t.x+e.x,t.y+e.y)},u.addByPoint=function(t,e){return new u(t.x+e.x,t.y+e.y,t.width,t.height)};var d=function(t,e,i){this.rect=new u(0,0,0,0),this.ctx=t,this.parent=null,this.childs=[],this.type=i||"notype",this.id=e||this.type+"_"+(new Date).getTime(),this.move=function(t,e){var i=new l(0,0);this.parent&&(i.x=this.parent.rect.x,i.y=this.parent.rect.y),this.rect.x=i.x+t,this.rect.y=i.y+e},this.hittest=function(t,e){return f(this.rect,new l(t,e))},this.getCenter=function(){return this.rect.getCenter()},this.addChild=function(t){t.parent=this,this.childs.push(t)}},p=function(t,e){d.call(this,e,t),this.connections=[],this.connect=function(t){var e=new a(this.ctx,this);e.connect(t),this.connections.push(e)},this.disconnect=function(){},this.draw=function(){for(var t in this.connections)this.connections[t].draw()}};p.prototype=new d,p.prototype.constructor=p;var y=p,w=function t(e,i,n){y.call(this,e,i),this.rect.width=50,this.rect.height=50,this.o=n.createOscillator(),this.o.type="sine",this.o.frequency.value=0,this.o.start(),this.draw=function(){t.prototype.draw.call(this),i.fillStyle="grey",i.fillRect(this.rect.x,this.rect.y,this.rect.width,this.rect.height),i.font="30px Arial",i.fillStyle="white",i.fillText("type : "+this.o.type,this.rect.x,this.rect.y)}};w.prototype=new y,w.prototype.constructor=w;var v=w,m=function(t,e,i){this.ctx=e,this.name=t,this.o=i.crea,this.destination="",this.draw=function(){},this.connectTo=function(t){this.o.connect(t.o)},this.setNote=function(t){this.o.frequency.value=t}},b=(i("cb29"),function t(e,i){y.call(this,"sourceInput",e),this.rect.width=20,this.rect.height=10,this.audioCtx=i,this.source=this.audioCtx.createConstantSource(),this.start=function(){this.source.start()},this.connect=function(e){this.source.connect(e.o.frequency),t.prototype.connect.call(this,e)},this.playNote=function(t){this.source.offset.value=t},this.draw=function(){t.prototype.draw.call(this),e.fillStyle="white",e.beginPath(),e.arc(this.rect.x,this.rect.y,this.rect.width,0,2*Math.PI),e.fill(),e.stroke()}});b.prototype=new y,b.prototype.constructor=b;var x=b,g=function(t,e){d.call(this,t,"finalGain"),this.rect.width=20,this.rect.height=10,this.audioCtx=e,this.finalGain=this.audioCtx.createGain(),this.finalGain.connect(this.audioCtx.destination),this.start=function(){this.source.start()},this.connect=function(t){this.source.connect(t)},this.playNote=function(t){this.source.offset.value=t},this.draw=function(){t.fillStyle="red",t.beginPath(),t.arc(this.rect.x,this.rect.y,this.rect.width,0,2*Math.PI),t.fill(),t.stroke()}};g.protytype=new d,g.prototype.constructor=g;var O=g;n["a"].use(h["a"]);var j=new h["a"].Store({state:{test:[],childObjs:{},sourceInput:Object,finalGain:Object,ctx:Object,audioCtx:Object,redraw:0,reevalute:1},getters:{childObjs:function(t){return t.childObjs},redraw:function(t){return t.redraw},lengthOfChild:function(t){if(t.reevalute)return Object.keys(t.childObjs).length}},mutations:{setCtx:function(t,e){t.ctx=e},setAudioCtx:function(t,e){t.audioCtx=e},addOsc:function(t,e){t.childObjs[e]=new v(e,t.ctx,t.audioCtx),t.reevalute++},addBus:function(t,e){t.childObjs[e]=new m(e,t.ctx)},playNote:function(t,e){t.sourceInput.playNote(e)},connect:function(t,e,i){t.childObjs[e].o.connect(t.childObjs[i].o)},connectToOutput:function(t,e){t.childObjs[e].o.connect(t.finalGain.finalGain),t.childObjs[e].connect(t.finalGain)},setSource:function(t,e){t.sourceInput.connect(t.childObjs[e])},changeOscType:function(t,e){t.childObjs[e.name].o.type=e.type},initSourceInput:function(t){t.sourceInput=new x(t.ctx,t.audioCtx),t.sourceInput.start(),t.childObjs["sourceInput"]=t.sourceInput},initFinalGain:function(t){t.finalGain=new O(t.ctx,t.audioCtx),t.childObjs["finalGain"]=t.finalGain},move:function(t,e){t.childObjs[e.name].move(e.position.x,e.position.y)},redraw:function(t){t.redraw++}}}),$=function(){var t=this;t.mouseDown=!1,t.selectedObj=null,t.previousPoint=new l(0,0),this.onMouseMove=function(e){if(t.selectedObj){var i=e.offsetX-t.previousPoint.x,n=e.offsetY-t.previousPoint.y,s=t.selectedObj.rect;t.selectedObj.move(s.x+i,s.y+n),j.commit("redraw")}t.previousPoint.x=e.offsetX,t.previousPoint.y=e.offsetY},this.onMouseDown=function(e){for(var i in t.previousPoint.x=e.offsetX,t.previousPoint.y=e.offsetY,j.getters.childObjs){var n=j.getters.childObjs[i];n.hittest(e.offsetX,e.offsetY)&&(t.selectedObj=n)}},this.onMouseUp=function(){t.selectedObj=null}},C={data:function(){return{interaction:new $}},props:{width:{type:Number,default:500},height:{type:Number,default:400}},mounted:function(){this.$refs.canvas.addEventListener("mousedown",this.interaction.onMouseDown),this.$refs.canvas.addEventListener("mouseup",this.interaction.onMouseUp),this.$refs.canvas.addEventListener("mousemove",this.interaction.onMouseMove),this.$store.commit("setCtx",this.$refs.canvas.getContext("2d")),this.$store.commit("setAudioCtx",new AudioContext),this.$store.commit("initSourceInput"),this.$store.commit("initFinalGain"),this.$store.commit("move",{name:"sourceInput",position:{x:30,y:200}}),this.$store.commit("move",{name:"finalGain",position:{x:450,y:200}});var t=this.$store.getters.lengthOfChild;this.$store.commit("addOsc",t),this.$store.commit("connectToOutput",t),this.$store.commit("changeOscType",{name:t,type:"triangle"}),this.$store.commit("setSource",t),this.$store.commit("move",{name:t,position:{x:100,y:100}}),this.draw()},computed:Object(h["b"])(["childObjs","ctx","sourceInput","finalGain","redraw"]),watch:{childObjs:function(){this.draw()},redraw:function(){this.draw()}},methods:{draw:function(){for(var t in this.ctx.fillStyle="black",this.ctx.fillRect(0,0,this.width,this.height),this.childObjs)this.childObjs[t].draw();this.sourceInput.draw(),this.finalGain.draw()}}},k=C,M=i("2877"),P=Object(M["a"])(k,r,c,!1,null,null,null),S=P.exports,_=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"CtrlPanel"}},[i("button",{on:{click:t.add}},[t._v("Oscillator")]),i("button",[t._v("Reverb")]),i("button",[t._v("Delay")])])},G=[],D={props:{width:{type:Number,default:500},height:{type:Number,default:100}},methods:{add:function(){var t=this.$store.getters.lengthOfChild+1;console.log(t),this.$store.commit("addOsc",t),this.$store.commit("addOsc",t),this.$store.commit("connectToOutput",t),this.$store.commit("changeOscType",{name:t,type:"triangle"}),this.$store.commit("setSource",t);var e=1e3*Math.random()%50,i=Math.random()<.5?-1:1;this.$store.commit("move",{name:t,position:{x:100+e*i,y:100+e*i}}),this.$store.commit("redraw")}},mounted:function(){}},I=D,N=Object(M["a"])(I,_,G,!1,null,null,null),T=N.exports,E=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"Keyboard"},[i("canvas",{ref:"canvas",staticClass:"canvas",attrs:{width:t.width,height:t.height}})])},q=[],B=(i("4160"),i("4e82"),i("d3b7"),i("159b"),i("ddb0"),[16.35,17.32,18.35,19.45,20.6,21.83,23.12,24.5,25.96,27.5,29.14,30.87]);function L(){this.frequency=0,this.rt=new u(0,0,0,0),this.color="white"}function X(t,e){return t.color==e.color?0:"white"==t.color?-1:1}var Y={props:{width:{type:Number,default:500},height:{type:Number,default:80}},data:function(){return{keys:[],mouseDown:!1}},mounted:function(){this.ctx=this.$refs.canvas.getContext("2d"),this.ctx.fillStyle="black",this.$refs.canvas.addEventListener("mousedown",this.onMouseDown),this.$refs.canvas.addEventListener("mouseup",this.onMouseUp),this.$refs.canvas.addEventListener("mousemove",this.onMouseMove);for(var t=0,e=25,i=13,n=0;n<55;n++){var s=n%12,o=new L;o.freq=B[n%12]*Math.pow(2,Math.floor(n/12+1))*4,1==s||3==s||6==s||8==s||10==s?(o.rt=new u(t-.3*e,0,i,.6*this.height),o.color="black"):(o.rt=new u(t,0,e,this.height),o.color="white",t=o.rt.x+e),this.keys.push(o)}this.keys.sort(X),this.draw()},watch:{},methods:{onMouseDown:function(t){for(var e=this.keys.length,i=e-1;i>=0;i--){var n=this.keys[i];if(n.pressed=!1,f(n.rt,new l(t.offsetX,t.offsetY))){this.mouseDown=!0,n.pressed=!0,this.$store.commit("playNote",n.freq);break}}for(var s=i-1;s>=0;s--)this.keys[s].pressed=!1;this.draw()},onMouseUp:function(){this.mouseDown=!1,this.keys.forEach((function(t){t.pressed=!1})),this.$store.commit("playNote",0),this.draw()},onMouseMove:function(t){if(this.mouseDown){for(var e=this.keys.length,i=e-1;i>=0;i--){var n=this.keys[i];if(n.pressed=!1,f(n.rt,new l(t.offsetX,t.offsetY))){this.mouseDown=!0,n.pressed=!0,this.$store.commit("playNote",n.freq);break}}for(var s=i-1;s>=0;s--)this.keys[s].pressed=!1;this.draw()}},draw:function(){var t=this;this.ctx.beginPath(),this.ctx.rect(0,0,this.width,this.height),this.ctx.stroke(),this.keys.forEach((function(e){t.ctx.beginPath(),e.pressed?t.ctx.fillStyle="#FDDFDF":t.ctx.fillStyle=e.color,t.ctx.fillRect(e.rt.x,e.rt.y,e.rt.width,e.rt.height),t.ctx.strokeStyle="black",t.ctx.rect(e.rt.x,e.rt.y,e.rt.width,e.rt.height),t.ctx.stroke()}))}}},F=Y,A=Object(M["a"])(F,E,q,!1,null,null,null),R=A.exports,U={name:"Beige",components:{Board:S,Keyboard:R,CtrlPanel:T}},K=U,J=(i("034f"),Object(M["a"])(K,s,o,!1,null,null,null)),z=J.exports;n["a"].config.productionTip=!1,new n["a"]({store:j,render:function(t){return t(z)}}).$mount("#app")},"85ec":function(t,e,i){}});
//# sourceMappingURL=app.2d277d53.js.map